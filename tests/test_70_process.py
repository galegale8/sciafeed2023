
from datetime import datetime
from os.path import exists, join
import os

from sciafeed import process, arpa19

from . import TEST_DATA_PATH


def test_make_report(tmpdir):
    parameters_filepath = join(TEST_DATA_PATH, 'arpa19', 'arpa19_params.csv')
    # no errors
    in_filepath = join(TEST_DATA_PATH, 'arpa19', 'loc01_70001_201301010000_201401010100.dat')
    limiting_params = {'3': ('4', '5')}
    out_filepath = str(tmpdir.join('report.txt'))
    outdata_filepath = str(tmpdir.join('data.csv'))
    assert not exists(out_filepath)
    assert not exists(outdata_filepath)
    msgs, data_parsed = process.make_report(
        in_filepath, out_filepath, outdata_filepath, parameters_filepath=parameters_filepath,
        limiting_params=limiting_params)
    assert exists(out_filepath)
    assert exists(outdata_filepath)
    assert "No errors found" in msgs
    assert data_parsed == arpa19.parse(in_filepath, parameters_filepath)[0]

    # some formatting errors
    in_filepath = join(TEST_DATA_PATH, 'arpa19', 'wrong_70001_201301010000_201401010100.dat')
    limiting_params = {'3': ('4', '5')}
    out_filepath = str(tmpdir.join('report2.txt'))
    outdata_filepath = str(tmpdir.join('data2.csv'))
    assert not exists(out_filepath)
    assert not exists(outdata_filepath)
    msgs, data_parsed = process.make_report(
        in_filepath, out_filepath, outdata_filepath, parameters_filepath=parameters_filepath,
        limiting_params=limiting_params)
    assert exists(out_filepath)
    assert exists(outdata_filepath)
    err_msgs = [
        "Row 2: The spacing in the row is wrong",
        'Row 3: the latitude changes',
        'Row 5: it is not strictly after the previous',
        'Row 21: duplication of rows with different data',
        'Row 22: the time is not coherent with the filename',
    ]
    for err_msg in err_msgs:
        assert err_msg in msgs
    assert data_parsed == [
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'FF', 0.9, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'DD', 355.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'Tmedia', 6.8, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'UR media', 83.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), '12', 1020.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 1, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2012, 12, 31, 23, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'FF', 0.9, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'DD', 1.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'Tmedia', 6.4, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'UR media', 88.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), '12', 1018.4, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 4, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 3, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'FF', 3.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'DD', 6.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'Tmedia', 6.7, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'UR media', 89.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), '12', 1018.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 7, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 4, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'FF', 3.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'DD', 6.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'Tmedia', 6.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'UR media', 93.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), '12', 1018.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 8, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 5, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'FF', 2.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'DD', 358.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'Tmedia', 6.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'UR media', 93.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), '12', 1018.2, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 9, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 6, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'FF', 0.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'DD', 342.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'Tmedia', 6.6, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'UR media', 95.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), '12', 1018.2, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 10, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 7, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'FF', 3.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'DD', 12.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'Tmedia', 10.6, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'UR media', 88.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), '12', 1017.9, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 11, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 8, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'FF', 1.3, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'DD', 154.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'Tmedia', 12.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'UR media', 72.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), '12', 1018.2, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 12, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 9, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'FF', 5.4, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'DD', 218.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'Tmedia', 12.3, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'UR media', 69.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), '12', 1017.7, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 13, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 10, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'FF', 6.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'DD', 225.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'Tmedia', 12.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'UR media', 73.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), '12', 1016.7, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 14, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 11, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'FF', 6.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'DD', 226.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'Tmedia', 12.2, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'UR media', 74.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), '12', 1016.2, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 15, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 12, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'FF', 4.6, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'DD', 221.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'Tmedia', 11.7, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'UR media', 78.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), '12', 1016.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 16, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 13, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'FF', 1.9, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'DD', 233.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'Tmedia', 11.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'UR media', 82.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), '12', 1016.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 17, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 14, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'FF', 2.8, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'DD', 355.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'Tmedia', 10.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'UR media', 96.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), '12', 1015.8, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 18, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 15, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'FF', 2.4, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'DD', 345.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'Tmedia', 9.9, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'UR media', 96.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), '12', 1015.6, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 19, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 16, 0), 'Bagnatura_f', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'FF', 2.6, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'DD', 357.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'Tmedia', 10.1, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'Tmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'Tmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), '6', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), '7', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), '8', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'UR media', 97.0, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'UR min', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'UR max', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), '12', 1015.5, True),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'P', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'Pmin', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'Pmax', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'RADSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'INSOL', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'PREC', None, False),
        ({'cod_utente': '70001', 'end_date': datetime(2014, 1, 1, 1, 0), 'format': 'ARPA-19', 'lat': 43.876999, 'row': 20, 'source': 'arpa19/wrong_70001_201301010000_201401010100.dat', 'start_date': datetime(2013, 1, 1, 0, 0)}, datetime(2013, 1, 1, 17, 0), 'Bagnatura_f', None, False),
    ]
    # some errors
    in_filepath = join(TEST_DATA_PATH, 'arpa19', 'wrong_70002_201301010000_201401010100.dat')
    limiting_params = {'Tmedia': ('FF', 'DD')}
    out_filepath = str(tmpdir.join('report3.txt'))
    outdata_filepath = str(tmpdir.join('data3.csv'))
    assert not exists(out_filepath)
    assert not exists(outdata_filepath)
    msgs, data_parsed = process.make_report(
        in_filepath, out_filepath, outdata_filepath, parameters_filepath=parameters_filepath,
        limiting_params=limiting_params)
    assert exists(out_filepath)
    assert exists(outdata_filepath)
    err_msgs = [
        "Row 1: The value of 'FF' is out of range [0.0, 102.0]",
        "Row 2: The value of 'DD' is out of range [0.0, 360.0]",
        "Row 3: The value of 'Tmedia' is out of range [-35.0, 45.0]",
        "Row 5: The values of 'Tmedia' and 'DD' are not consistent",
        "Row 6: The values of 'Tmedia' and 'DD' are not consistent",
        "Row 7: The values of 'Tmedia' and 'DD' are not consistent",
        "Row 20: The values of 'Tmedia' and 'DD' are not consistent"
    ]
    for err_msg in err_msgs:
        assert err_msg in msgs


def test_compute_daily_indicators(conn, tmpdir):
    data_folder = join(TEST_DATA_PATH, 'indicators', 'input')
    indicators_folder = str(tmpdir.join('indicators_out'))
    dumped_result_exp_file = join(TEST_DATA_PATH, 'indicators', 'expected', 'result.txt')
    os.mkdir(indicators_folder)
    computed_indicators = process.compute_daily_indicators(
        conn, data_folder, indicators_folder)
    with open(dumped_result_exp_file) as fp:
        dumped_result_exp = fp.read()
        assert str(computed_indicators) == dumped_result_exp.strip()
